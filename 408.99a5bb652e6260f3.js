"use strict";(self.webpackChunksocial_face=self.webpackChunksocial_face||[]).push([[408],{2408:(q,p,l)=>{l.r(p),l.d(p,{SettingsModule:()=>I});var d=l(6895),h=l(2127),a=l(433),v=l(9300),U=l(8505),Z=l(3900),b=l(4004),t=l(4650),C=l(6271),g=l(7178);function T(i,f){1&i&&(t.TgZ(0,"div",22),t._uU(1," * First Name is required "),t.qZA())}function S(i,f){1&i&&(t.TgZ(0,"div",22),t._uU(1," * Last Name is required "),t.qZA())}function A(i,f){1&i&&(t.TgZ(0,"div",22),t._uU(1," * Phone Number is required "),t.qZA())}function y(i,f){1&i&&(t.TgZ(0,"div",22),t._uU(1," * Notification is required "),t.qZA())}const j=[{path:"",component:(()=>{class i{constructor(e,o,n){this.formBuilder=e,this.authFacade=o,this.postFacade=n,this.form=this.formBuilder.nonNullable.group({firstname:["",a.kI.required],lastname:["",a.kI.required],phonenumber:[""],notifications:["",a.kI.required]}),this.posts=[]}ngOnInit(){this.authFacade.currentUser$.pipe((0,v.h)(e=>null!=e),(0,U.b)(e=>{e&&this.postFacade.fetchAllPostsByUserId(e.id)}),(0,Z.w)(e=>this.postFacade.posts$.pipe((0,b.U)(o=>({posts:o,currentUser:e}))))).subscribe(({currentUser:e,posts:o})=>{this.currentUser=e,this.posts=o||[],this.initializeForm()})}initializeForm(){if(!this.currentUser)throw new Error("Current user is not set");this.form.patchValue({firstname:this.currentUser.firstname,lastname:this.currentUser.lastname,phonenumber:this.currentUser.phonenumber,notifications:this.currentUser.notifications})}onSubmit(){if(!this.currentUser)throw new Error("current user is not set");const e={...this.currentUser,...this.form.getRawValue()};this.authFacade.updateCurrentUser(e)}getHeaders(e){return Object.keys(e)}createPostsCsv(){let e=this.getHeaders(this.posts[0]),o=this.posts.map(s=>e.map(u=>{let r="";return r="author"===u?`${Object.keys(s.author).map(c=>s.author[c]).join("/")}`:"tagList"===u?s.tagList.map(c=>c).join("/"):(s[u]?.toString()||" ").replace(","," "),r}).join(","));return[e.join(","),...o].join("\n")}createUserInformationCsv(e){let o=this.getHeaders(e),n=o.map(s=>{let m="";return"friends"!==s&&"photos"!==s?m=e[s]?.toString()||"":"photos"===s&&(m=e.photos.join("/")),m}).join(",");return[o.filter(s=>"friends"!==s).join(","),n].join("\n")}createUserFriendsCsv(e){return e.map(n=>{let s=[],m=[],u="";return Object.keys(n).forEach(r=>{"object"!=typeof n[r]&&"friends"!==r&&"photos"!==r?u=n[r]?.toString()||"":"photos"===r&&(u=n.photos?.join("/")||""),s.push(r),m.push(u)}),[s.join(","),m.join(",")].join("\n")}).join("\n")}exportToCSV(){if(this.currentUser&&this.posts.length){const e=this.createPostsCsv(),s=["USER INFORMATION",this.createUserInformationCsv(this.currentUser),"USER POSTS",e,"USER FRIENDS",this.createUserFriendsCsv(this.currentUser.friends)].join("\n"),m=new File([s],"UserInformationCsv.csv",{type:"text/plain"}),u=URL.createObjectURL(m),r=document.createElement("a");r.style.display="none",r.href=u,r.download=m.name,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(u)}}static#t=this.\u0275fac=function(o){return new(o||i)(t.Y36(a.qu),t.Y36(C.j),t.Y36(g.T))};static#n=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-settings"]],decls:58,vars:13,consts:[["id","main",1,"form-box"],["action","",3,"formGroup","ngSubmit"],[1,"input-group"],[1,"input-group-item"],[1,"input-group-item-label"],["for","firstname"],[1,"input-field",3,"ngClass"],[1,"fa-solid","fa-user"],["type","text","name","firstname","id","firstname","formControlName","firstname"],["class","error-message",4,"ngIf"],["for","lastname"],["type","text","name","lastname","id","lastname","formControlName","lastname"],["for","phonenumber"],["type","tel","name","phonenumber","id","phonenumber","formControlName","phonenumber"],["for","notifications"],["type","text","name","notifications","id","notifications","formControlName","notifications"],["value","","disabled","","selected",""],[3,"value"],[1,"required-fields"],[1,"btn-field"],["type","submit",1,"button","button-blue",3,"ngClass","disabled"],["type","button",1,"button","button-blue",3,"click"],[1,"error-message"]],template:function(o,n){1&o&&(t.TgZ(0,"main",0)(1,"h1"),t._uU(2,"Settings"),t.qZA(),t.TgZ(3,"form",1),t.NdJ("ngSubmit",function(){return n.onSubmit()}),t.TgZ(4,"div",2)(5,"div",3)(6,"div",4)(7,"span"),t._uU(8,"*"),t.qZA(),t.TgZ(9,"label",5),t._uU(10,"First Name"),t.qZA()(),t.TgZ(11,"div",6),t._UZ(12,"i",7)(13,"input",8),t.qZA()(),t.YNc(14,T,2,0,"div",9),t.TgZ(15,"div",3)(16,"div",4)(17,"span"),t._uU(18,"*"),t.qZA(),t.TgZ(19,"label",10),t._uU(20,"Last Name"),t.qZA()(),t.TgZ(21,"div",6),t._UZ(22,"i",7)(23,"input",11),t.qZA()(),t.YNc(24,S,2,0,"div",9),t.TgZ(25,"div",3)(26,"div",4)(27,"span"),t._uU(28,"*"),t.qZA(),t.TgZ(29,"label",12),t._uU(30,"Phone Number"),t.qZA()(),t.TgZ(31,"div",6),t._UZ(32,"i",7)(33,"input",13),t.qZA()(),t.YNc(34,A,2,0,"div",9),t.TgZ(35,"div",3)(36,"div",4)(37,"span"),t._uU(38,"*"),t.qZA(),t.TgZ(39,"label",14),t._uU(40,"Notifications"),t.qZA()(),t.TgZ(41,"div",6),t._UZ(42,"i",7),t.TgZ(43,"select",15)(44,"option",16),t._uU(45,"--Select Notification--"),t.qZA(),t.TgZ(46,"option",17),t._uU(47,"Email"),t.qZA(),t.TgZ(48,"option",17),t._uU(49,"In App Notification"),t.qZA()()()(),t.YNc(50,y,2,0,"div",9),t.TgZ(51,"p",18),t._uU(52,"* Required Fields"),t.qZA()(),t.TgZ(53,"div",19)(54,"button",20),t._uU(55," Update Information "),t.qZA(),t.TgZ(56,"button",21),t.NdJ("click",function(){return n.exportToCSV()}),t._uU(57," Export Information "),t.qZA()()()()),2&o&&(t.xp6(3),t.Q6J("formGroup",n.form),t.xp6(8),t.Q6J("ngClass",n.form.controls.firstname.invalid&&(n.form.controls.firstname.dirty||n.form.controls.firstname.touched)?"input-field-invalid":""),t.xp6(3),t.Q6J("ngIf",n.form.controls.firstname.invalid&&(n.form.controls.firstname.dirty||n.form.controls.firstname.touched)),t.xp6(7),t.Q6J("ngClass",n.form.controls.lastname.invalid&&(n.form.controls.lastname.dirty||n.form.controls.lastname.touched)?"input-field-invalid":""),t.xp6(3),t.Q6J("ngIf",n.form.controls.lastname.invalid&&(n.form.controls.lastname.dirty||n.form.controls.lastname.touched)),t.xp6(7),t.Q6J("ngClass",n.form.controls.phonenumber.invalid&&(n.form.controls.phonenumber.dirty||n.form.controls.phonenumber.touched)?"input-field-invalid":""),t.xp6(3),t.Q6J("ngIf",n.form.controls.phonenumber.invalid&&(n.form.controls.phonenumber.dirty||n.form.controls.phonenumber.touched)),t.xp6(7),t.Q6J("ngClass",n.form.controls.notifications.invalid&&(n.form.controls.notifications.dirty||n.form.controls.notifications.touched)?"input-field-invalid":""),t.xp6(5),t.Q6J("value","email"),t.xp6(2),t.Q6J("value","inApp"),t.xp6(2),t.Q6J("ngIf",n.form.controls.notifications.invalid&&(n.form.controls.notifications.dirty||n.form.controls.notifications.touched)),t.xp6(4),t.Q6J("ngClass",n.form.invalid&&(n.form.touched||n.form.dirty)?"button-disable":"")("disabled",n.form.invalid&&(n.form.touched||n.form.dirty)))},dependencies:[d.mk,d.O5,a._Y,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.JL,a.sg,a.u],styles:[".settings-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;padding:13px 5%;justify-content:center;align-items:center}"]})}return i})()}];let N=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#n=this.\u0275mod=t.oAB({type:i});static#e=this.\u0275inj=t.cJS({imports:[h.Bz.forChild(j),h.Bz]})}return i})(),I=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#n=this.\u0275mod=t.oAB({type:i});static#e=this.\u0275inj=t.cJS({providers:[g.T],imports:[d.ez,N,a.UX]})}return i})()}}]);